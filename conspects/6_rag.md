<div class="alert alert-info">
    
üìñ –ë–æ–ª—å—à–∏–µ —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –∑–Ω–∞—é—Ç –æ—á–µ–Ω—å –º–Ω–æ–≥–æ, –Ω–æ –¥–∞–ª–µ–∫–æ –Ω–µ –≤—Å—ë. –û—Å–æ–±–µ–Ω–Ω–æ, —á—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –≤–∞—à–∏—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–ª–∏ –ª—é–±–∏–º—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã). 

–ú–æ–∂–Ω–æ, –∫–æ–Ω–µ—á–Ω–æ, –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–æ–æ–±—É—á–∏—Ç—å LLM –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–æ —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–∏—Ö –∑–∞—Ç—Ä–∞—Ç –≤—Ä–µ–º–µ–Ω–∏, –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –æ–±—ä—ë–º–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ —Ä–∞–∑–º–µ—á–µ–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞. <br>

<div class="alert alert-info">
    
–ó–¥–µ—Å—å –∫ –Ω–∞–º –Ω–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø–æ–¥—Ö–æ–¥, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –ø—Ä–æ–º–ø—Ç–∞—Ö, `RAG` - –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –≤ 2021 –≥–æ–¥—É –∫–æ–º–∞–Ω–¥–æ–π FAIR (Facebook AI Research). –°–ø–æ—Å–æ–± –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –≤ —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ –Ω–µ—Ç –±–æ–ª—å—à–æ–≥–æ –æ–±—ä—ë–º–∞ –¥–∞–Ω–Ω—ã—Ö, –≤—Ä–µ–º–µ–Ω–∏ –∏ –±—é–¥–∂–µ—Ç–∞ –Ω–∞ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å –¥–æ–æ–±—É—á–µ–Ω–∏–µ–º –º–æ–¥–µ–ª–µ–π, –∞ —ç—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –±–∏–∑–Ω–µ—Å-–∫–µ–π—Å–æ–≤. –≠—Ç–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –º–æ—â–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –ø—Ä–∏ —ç—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω–æ–π.<br>

##  <center> ‚ùìüßë‚Äçüéì –¢–∞–∫ —á—Ç–æ –∂–µ —Ç–∞–∫–æ–µ RAG ? </center>

<div class="alert alert-info">
    
![alt text](image_2.png)

–ù–µ –≤–¥–∞–≤–∞—è—Å—å –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ RAG —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤ (—Å–º. —Ä–∏—Å—É–Ω–æ–∫):

<div class="alert alert-success">

1. ‚öæÔ∏è –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø—Ä–æ–º–ø—Ç —Å –∑–∞–ø—Ä–æ—Å–æ–º.
2. üìö –°–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –∑–∞—Ä–∞–Ω–µ–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –¥–∞—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å.
3. üß© –í –ø—Ä–æ–º–ø—Ç, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã.
4. ü§ì –ì–æ—Ç–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ LLM.
5. ü§ñ LLM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç —Å–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è.
</div>

![alt text](image_3.png)

# <center id="p2"> üì• Document loader & Text Splitter ‚öîÔ∏è </center>

## <center id="p2.1">  üöõ Document loaders

![alt text](image_4.png)

–í `LangChain` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ë—Ä—Ç–æ–∫ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ (–Ω–∞ —Ä–∏—Å—É–Ω–∫–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –º–∞–ª–∞—è —á–∞—Å—Ç—å). <br>

<div class="alert alert-success"> 
    
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `document loader'–∞` –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º —à–∞–≥–æ–º. –ï—Å–ª–∏ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤, —Ç–æ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –≤ Python üêç. <br>
–°–ª–µ–¥—É–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –ª–æ–∞–¥–µ—Ä–∞, —Ç–∞–∫ –∫–∞–∫ –º–æ–≥—É—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –Ω–µ–Ω—É–∂–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö.

```python
import pandas as pd
from langchain.document_loaders import DataFrameLoader

df = pd.read_csv("../data/Data.csv") # columns: ['Product', 'Review']
loader = DataFrameLoader(df, page_content_column="Review")
documents = loader.load()
print(documents[0])


from langchain.document_loaders import CSVLoader
loader = CSVLoader(file_path="../data/Data.csv")
documents = loader.load()
print(documents[0])
```

<div class="alert alert-success">

–ï—â—ë –æ–¥–∏–Ω —É–¥–æ–±–Ω—ã–π –∏ —á–∞—Å—Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ–º—ã–π –ª–æ–∞–¥–µ—Ä - `DirectoryLoader`. –£–¥–æ–±–µ–Ω, –∫–æ–≥–¥–∞ —É –≤–∞—Å –µ—Å—Ç—å –∫–∞—Ç–∞–ª–æ–≥ —Ñ–∞–π–ª–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏.
```python
from langchain_community.document_loaders import DirectoryLoader

loader = DirectoryLoader('../', glob="**/*.md")
```
–ü—Ä–æ—Å—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç–µ –ø—É—Ç—å –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤).


## <center id="p2.2"> üññ Text splitters - —Ä–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã

![alt text](image_5.png)

    
–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:

<div class="alert alert-success">
    
* –†–∞–∑–¥–µ–ª–∏—Ç—å –∏—Ö –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –æ—Ç—Ä—ã–≤–∫–∏ (–¥–æ–∫—É–º–µ–Ω—Ç—ã),
* –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ —á—Ç–æ–±—ã —ç—Ç–∞ —Ä–∞–∑–±–∏–≤–∫–∞ –±—ã–ª–∞ –ª–æ–≥–∏—á–Ω–æ–π –∏ —Å–æ–¥–µ—Ä–∂–∞–ª–∞ –∑–∞–∫–æ–Ω—á–µ–Ω–Ω—É—é –º—ã—Å–ª—å. **–ù–∞–ø—Ä–∏–º–µ—Ä**, –∞–±–∑–∞—Ü –∫–Ω–∏–≥–∏ –∏–ª–∏ –ø–æ–ª–Ω–∞—è —Å—Ç–∞—Ç—å—è –∑–∞–∫–æ–Ω–∞ –∏–ª–∏ –∫–æ–¥–µ–∫—Å–∞.
* –ü—Ä–∏ —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–≥—Ä–æ–º–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, —á—Ç–æ–±—ã –≤–ª–µ–∑—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –æ–∫–Ω–æ –º–æ–¥–µ–ª–∏.
</div>

<div class="alert alert-info">


–ú–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–∑–±–∏–≤–∫–∏ (–≤—ã–±–æ—Ä–∞ —Å–ø–ª–∏—Ç—Ç–µ—Ä–∞) –Ω–∞–ø—Ä—è–º—É—é –∑–∞–≤–∏—Å–∏—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ã –≤—Å–µ–≥–æ `RAG`. –ü–æ—ç—Ç–æ–º—É, –¥–ª—è —Å–ª—É—á–∞–µ–≤ –∫–æ–≥–¥–∞ –≤ —Ç–µ–∫—Å—Ç–∞—Ö —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–∫–æ–¥–µ–∫—Å—ã, –∑–∞–∫–æ–Ω—ã, –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ã –∏.—Ç.–ø.), —á–∞—Å—Ç–æ –ø–∏—à—É—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ø–ª–∏—Ç—Ç–µ—Ä—ã. <br>

–ù–∏–∂–µ —Ä–∞–∑–±–µ—Ä—ë–º –¥–≤–∞ —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–ø–ª–∏—Ç—Ç–µ—Ä–∞ –∏–∑ `LangChain` (–æ—Å—Ç–∞–ª—å–Ω—ã–µ [—Ç—É—Ç](https://python.langchain.com/docs/modules/data_connection/document_transformers/))

```python
# –ó–∞–≥—Ä—É–∑–∏–º —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º PEP8

with open("../data/PEP8.txt") as f:
    doc = f.read()
print(doc[:1000], len(doc))

# –°–Ω–∞—á–∞–ª–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Å–ø–ª–∏—Ç—Ç–µ—Ä–∞ - –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å–∏–º–≤–æ–ª—É –≤ —Ç–µ–∫—Å—Ç–µ.
from langchain.text_splitter import (
    CharacterTextSplitter,
    RecursiveCharacterTextSplitter,
)

splitter = CharacterTextSplitter(
    separator="\n\n",  # —Å–∏–º–≤–æ–ª-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–µ—Ä–µ—Ö–æ–¥ –∫ –Ω–æ–≤–æ–º—É –∞–±–∑–∞—Ü—É '\n\n'
    chunk_size=500,  # —Ä–∞–∑–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ —Å–∏–º–≤–æ–ª–∞—Ö
    chunk_overlap=100,  # –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–æ—Å–µ–¥–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å –¥—Ä—É–≥-–¥—Ä—É–≥–∞
    length_function=len,  # —Ñ—É–Ω–∫—Ü–∏—è, –ø–æ –∫–æ—Ç–æ—Ä–æ–π —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ä–∞–∑–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞
    is_separator_regex=False,  # —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º
)

split_documents = splitter.create_documents([doc])
print(len(split_documents))


splitter = RecursiveCharacterTextSplitter(
    chunk_size=500,
    chunk_overlap=100,
    length_function=len,
)
split_documents = splitter.create_documents([doc])
print(len(split_documents))
```

# <center id="p3"> üî§ ‚û°Ô∏è üî¢ Embedding models  </center>

<div class="alert alert-info">

# <center id="p3"> üî§ ‚û°Ô∏è üî¢ Embedding models  </center>

<div class="alert alert-info">

![alt text](image_6.png)
–ò—Ç–∞–∫, —Ç–µ–∫—Å—Ç –∏–∑ —Ñ–∞–π–ª–æ–≤ –ø–æ–ª—É—á–∏–ª–∏, –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ–∫—Ä–æ—à–∏–ª–∏. –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Å —ç—Ç–∏–º–∏ –∫—É—Å–∫–∞–º–∏ —Ç–µ–∫—Å—Ç–∞ –¥–µ–ª–∞—Ç—å? <br>

<div class="alert alert-success">
    
–ö–∞–∫ –≤—ã –∑–Ω–∞–µ—Ç–µ, –º–æ–¥–µ–ª—å —Å –±—É–∫–≤–∞–º–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ —É–º–µ–µ—Ç, –µ–π –Ω—É–∂–Ω–æ –Ω–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞–≤–∞—Ç—å —á–∏—Å–ª–∞. 
–î–ª—è —ç—Ç–æ–≥–æ –º—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–∞—à–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å –∏ –ø–æ–ª—É—á–∏—Ç—å –∏—Ö –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (—ç–º–±–µ–¥–¥–∏–Ω–≥–∏).
–ß—Ç–æ–±—ã –ø–æ—Ç–æ–º –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å –≤ –≤–µ–∫—Ç–æ—Ä –∏ –Ω–∞–π—Ç–∏ –ø–æ—Ö–æ–∂–∏–µ —Ç–µ–∫—Å—Ç—ã –ø–æ –±–ª–∏–∑–æ—Å—Ç–∏ –≤–µ–∫—Ç–æ—Ä–æ–≤.<br>

<div class="alert alert-info">

![alt text](image_7.png)


–í `LangChain` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã –∫ –æ–≥—Ä–æ–º–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –º–æ–¥–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–º–æ–¥–µ–ª–∏ —Å `HuggingFace`, `OpenAI`, `Llama` –∏ –¥—Ä.). <br>

<div class="alert alert-success">
    
–î–æ—Å—Ç–∞–≤–∞—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∏–∑ –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏:
* –ü–æ API - —Ç–æ–≥–¥–∞ –Ω—É–∂–µ–Ω  –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
* –õ–æ–∫–∞–ª—å–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É–≤ –º–æ–¥–µ–ª—å –Ω–∞ —Å–≤–æ—ë–º –∂–µ–ª–µ–∑–µ - —Ç–æ–≥–¥–∞ –Ω—É–∂–Ω—ã GPU

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞, –∞ –ø–æ—Ç–æ–º —Ä–∞–∑–±–µ—Ä–µ–º –∫–∞–∫–∏–µ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –∫–æ–≥–¥–∞:

## <center id="p3.1"> üî± –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –æ—Ç OpenAI (API) </center>


<div class="alert alert-info">

<img src='image_8.png' align="right" width="408" height="328" >

–ß—Ç–æ–±—ã –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è API-–∫–ª—é—á, –∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –±—É–¥—É—Ç —Ç—Ä–∞—Ç–∏—Ç—å—Å—è —Ç–æ–∫–µ–Ω—ã. –≠—Ç–æ –Ω–∞–¥–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ –ø—Ä–æ–¥—É–º—ã–≤–∞–Ω–∏–∏ –±—é–¥–∂–µ—Ç–∞, –∏–Ω–æ–≥–¥–∞ –±—é–¥–∂–µ—Ç –Ω–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –±—ã–≤–∞–µ—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º —Å –±—é–¥–∂–µ—Ç–æ–º –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç—É.<br>

<div class="alert alert-success">
    
–í –∫–∞—á–µ—Å—Ç–≤–µ —ç–º–±–µ–¥–¥–∏–Ω–≥-–º–æ–¥–µ–ª–∏ –æ—Ç OpenAI –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `"text-embedding-3-small"` —Å —Ä–∞–∑–º–µ—Ä–æ–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ `1536`. –¢.–µ. –ª—é–±–æ–π —Ç–µ–∫—Å—Ç —Ä–∞–∑–º–µ—Ä–æ–º –æ—Ç 10 –¥–æ 10000 —Å–∏–º–≤–æ–ª–æ–≤ –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω 1536 —á–∏—Å–ª–∞–º–∏.

```python
from openai import OpenAI

client = OpenAI(
    base_url="https://api.proxyapi.ru/openai/v1",
    api_key="<–ö–õ–Æ–ß>"
)

response = client.embeddings.create(
    input="Your text string goes here",
    model="text-embedding-3-small"
)

print(response.data[0].embedding)
```

## <center id="p3.2"> –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –æ—Ç HuggingFace ü§ó </center>

<div class="alert alert-info">

–ù–∞ `HuggingFace` —Å–µ–π—á–∞—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –±–æ–ª–µ–µ 40000 –º–æ–¥–µ–ª–µ–π. –í—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â—É—é –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º –º–æ–∂–Ω–æ –ø–æ [—Å—Å—ã–ª–∫–µ](https://huggingface.co/models). <br>
–ó–¥–µ—Å—å API-–∫–ª—é—á –Ω–µ –Ω—É–∂–µ–Ω, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –Ω–µ –Ω—É–∂–Ω–æ —Ç—Ä–∞—Ç–∏—Ç—å—Å—è –Ω–∞ —Ç–æ–∫–µ–Ω—ã. –ù–æ –Ω—É–∂–Ω–æ —Ç—Ä–∞—Ç–∏—Ç—å—Å—è –Ω–∞ –∞—Ä–µ–Ω–¥—É –∂–µ–ª–µ–∑–∞ –¥–ª—è —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏. <br>

<div class="alert alert-success"> 
    
–î–ª—è –ø—Ä–∏–º–µ—Ä–∞, –≤–æ–∑—å–º—ë–º –º–æ–¥–µ–ª—å `"cointegrated/LaBSE-en-ru"`, –∫–æ—Ç–æ—Ä–∞—è —Ö–æ—Ä–æ—à–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–µ–±—è –Ω–∞ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã—Ö –∏ –∞–Ω–≥–ª–æ—è–∑—ã—á–Ω—ã—Ö —Ç–µ–∫—Å—Ç–∞—Ö –∏ –≤–ª–µ–∑–∞–µ—Ç –Ω–∞ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É —Å 1–ì–ë –≤–∏–¥–µ–æ–ø–∞–º—è—Ç–∏, —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ. –†–∞–∑–º–µ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ —É –Ω–µ—ë `768`, —á—Ç–æ –≤ 2 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ, —á–µ–º —É OpenAI, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ –º–µ–Ω—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑—ã.

```python
from langchain.embeddings import HuggingFaceEmbeddings

# –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞, —É–∫–∞–∂–∏—Ç–µ 'device': 'cuda'
hf_embeddings_model = HuggingFaceEmbeddings(
    model_name="cointegrated/LaBSE-en-ru", model_kwargs={"device": "cpu"}
)

embeddings = hf_embeddings_model.embed_documents(
    [
        "–ü—Ä–∏–≤–µ—Ç!",
        "Hello World!",
        "How are you?",
    ]
)
```

<div class="alert alert-info">
    
–ß—Ç–æ –∂–µ –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —ç–º–±–µ–¥–¥–∏–Ω–≥-–º–æ–¥–µ–ª–∏?

* üí∞ –ë—é–¥–∂–µ—Ç - –Ω–∞ —á—Ç–æ –≤—ã–≥–æ–¥–Ω–µ–µ —Ç—Ä–∞—Ç–∏—Ç—å—Å—è, –Ω–∞ —Ç–æ–∫–µ–Ω—ã –∏–ª–∏ –Ω–∞ –∞—Ä–µ–Ω–¥—É –∂–µ–ª–µ–∑–∞ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏
* üß∂ –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ - –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç–æ, —Å–∫–æ–ª—å–∫–æ –º–µ—Å—Ç–∞ –±—É–¥–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏—Ö —Ö—Ä–∞–Ω–µ–Ω–∏—è (–æ—Ç 256 –¥–æ 4096 –∏ –±–æ–ª–µ–µ)
* ü™¢ –î–ª–∏–Ω–∞ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, —á–µ–º –¥–ª–∏–Ω–µ–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ —á–µ–º –±–æ–ª—å—à–µ –≤ –Ω–∏—Ö —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤, —Ç–µ–º –±–æ–ª—å—à–µ –Ω—É–∂–Ω–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤, —á—Ç–æ–±—ã —É–ª–∞–≤–ª–∏–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–∏—è. –¢–∞–∫–∂–µ –æ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∑–∞–≤–∏—Å–∏—Ç –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–æ–Ω–∫–∏–µ —Ä–∞–∑–ª–∏—á–∏—è —Å–º–æ–≥—É—Ç —É–ª–∞–≤–ª–∏–≤–∞—Ç—å—Å—è.
* ü•ëüçì –¢–µ–º–∞—Ç–∏–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–∑–∞–¥–∞—á–∞) - –º–æ–¥–µ–ª–∏ –ø–æ-—Ä–∞–∑–Ω–æ–º—É —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å —Ç–µ–∫—Å—Ç–∞–º–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–µ–º–∞—Ç–∏–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–¥–µ–ª–∏ –æ–±—É—á–µ–Ω–Ω—ã–µ –Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∏—Ö –∏–ª–∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–∞—Ö, –∏–ª–∏ –Ω–∞ –ø–æ—Å—Ç–∞—Ö –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö, –±—É–¥—É—Ç –≤—ã–¥–∞–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–º –ø–æ–∏—Å–∫–µ.
* üóÇ –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ - —Å–∫–æ–ª—å–∫–æ —è–∑—ã–∫–æ–≤ –º–æ–∂–µ—Ç —Ç–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª–Ω–∞—è `LaBSE` –Ω–∞ 119 —è–∑—ã–∫–æ–≤ –∑–∞–Ω–∏–º–∞–µ—Ç –≤ 4 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞.

<div class="alert alert-success">
    
–≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –æ—Ç `OpenAI` –Ω–µ —è–≤–ª—è—é—Ç—Å—è —Å–∞–º—ã–º–∏ –ª—É—á—à–∏–º–∏ –∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–º–∏ –ø–æ–¥ –ª—é–±—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –∫ —Ç–æ–º—É –∂–µ –ø–ª–∞—Ç–Ω—ã–µ. <br>
**–†–∞–±–æ—á–∏–π –∫–µ–π—Å:** –ø–æ–π—Ç–∏ –Ω–∞ [–ª–∏–¥–µ—Ä–±–æ—Ä–¥ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤](https://huggingface.co/spaces/mteb/leaderboard) –∏ –≤—ã–±—Ä–∞—Ç—å —Å–∞–º—ã–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–æ–¥ –∑–∞–¥–∞—á—É.



# <center id="p4"> üóÇ Vector Store - –º–µ—Å—Ç–æ –≥–¥–µ –∂–∏–≤—É—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–∏</center>


<div class="alert alert-info">

<img src='image_9.png' align="right" width="558" height="428" >

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –º—ã –≤—ã—Ç–∞—â–∏–ª–∏ –∏–∑ –º–æ–¥–µ–ª–∏ –Ω–∞—à–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏, –Ω–∞–º –Ω—É–∂–Ω–æ –≥–¥–µ-—Ç–æ –∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –∏ –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –ø–æ –Ω–∏–º –ø–æ–∏—Å–∫. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ. –í `LangChain` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ [–∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–æ–≤](https://github.com/langchain-ai/langchain/tree/master/libs/langchain/langchain/vectorstores) –∫–æ –≤—Å–µ–≤–æ–∑–º–æ–∂–Ω—ã–º –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö, –≤ —Ç–æ–º —á–∏—Å–ª–µ –∫ –æ–±–ª–∞—á–Ω—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º - —Ç.–µ. –±–∞–∑—É —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –º–æ–∂–Ω–æ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ, –∞ –ø–æ–ª—É—á–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ API. <br>
<div class="alert alert-success">

–í –æ—Å–Ω–æ–≤–Ω–æ–º, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–≤–∞ –æ–ø–µ–Ω—Å–æ—Ä—Å —Ä–µ—à–µ–Ω–∏—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ, –≤ —Ü–µ–ª–æ–º, –ø–æ—Ö–æ–∂–∏:
* `FAISS` - –æ—Ç FAIR - —Å–æ–∑–¥–∞—Ç–µ–ª–µ–π –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ RAG
* `ChromaDB` - –æ—Ç CHROMA-core

–°—Ç–æ–∏—Ç —Ç–∞–∫ –∂–µ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–ª–∞—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –æ—Ç `Pinecone` - –ø–æ–∫–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ, —Å–ø–æ—Å–æ–±–Ω–æ–µ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ `serverless` —Ä–µ–∂–∏–º–µ.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä —Å `FAISS`:

```python
from langchain.vectorstores import FAISS

embeddings = OpenAIEmbeddings(course_api_key=course_api_key)
db = FAISS.from_documents(
    split_documents[:70], embeddings
)  # —Å–æ–∑–¥–∞—ë–º –±–∞–∑—É, –≤–æ–∑—å–º—ë–º –ø–µ—Ä–≤—ã–µ 70 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —á—Ç–æ–±—ã —Ç—Ä–∞—Ç–∏—Ç—å –º–µ–Ω—å—à–µ —Ç–æ–∫–µ–Ω–æ–≤

db.save_local("faiss_db")  # –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–∞–∑—É –ª–æ–∫–∞–ª—å–Ω–æ, —É–∫–∞–∑–∞–≤ –ø—É—Ç—å

# –ë–∞–∑–∞ –≥–æ—Ç–æ–≤–∞, —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –∫ –Ω–µ–π –∑–∞–ø—Ä–æ—Å—ã
print(db.similarity_search("How many empty lines shuold be behind methods of a class?"))
print(db.similarity_search("–°–∫–æ–ª—å–∫–æ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫ –Ω—É–∂–Ω–æ –æ—Å—Ç–∞–≤–ª—è—Ç—å –º–µ–∂–¥—É –º–µ—Ç–æ–¥–∞–º–∏ –∫–ª–∞—Å—Å–∞?"))
print(db.similarity_search_with_score(
    "–°–∫–æ–ª—å–∫–æ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫ –Ω—É–∂–Ω–æ –æ—Å—Ç–∞–≤–ª—è—Ç—å –º–µ–∂–¥—É –º–µ—Ç–æ–¥–∞–º–∏ –∫–ª–∞—Å—Å–∞?"
)[:2])
```
# <center id="p5"> üé£ Retriever - –≤—ã—É–¥–∏ –Ω—É–∂–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç. </center>

<div class="alert alert-info">

<img src='image_10.png' align="right" width="228" height="250" >

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Ç—Ä–∏–≤–µ—Ä–∞, —Ç–æ–∂–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º —à–∞–≥–æ–º –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è `RAG`. –ü–æ—Ç–æ–º—É —á—Ç–æ –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ —Å–∞–º–∞ –º–æ–∂–µ—Ç –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å –ø–æ–∏—Å–∫ –ø–æ —Å—Ö–æ–∂–µ—Å—Ç–∏ –∏ –≤—ã–¥–∞–≤–∞—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –∑–∞—Ç–µ–º –º–æ–∂–µ–º –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –≤ –ø—Ä–æ–º–ø—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. <br>

    
**–†–µ—Ç—Ä–∏–≤–µ—Ä** - —ç—Ç–æ —Ç–∞–∫–∞—è –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–¥ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å –ø–æ—Ö–æ–∂–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, –Ω–æ –Ω–µ –æ–±—è–∑–∞–Ω–∞ –∏—Ö —Ö—Ä–∞–Ω–∏—Ç—å. <br>

–î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, –Ω—É–∂–Ω–æ –ª–∏ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –∑–∞—á–µ–º:



```python
# –°–∞–º—ã–π —á–∞—Å—Ç—ã–π –∫–µ–π—Å - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ –µ–≥–æ –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
retriever = db.as_retriever(
    search_type="similarity",  # —Ç–∏–ø –ø–æ–∏—Å–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
    k=4,  # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (Default: 4)
    score_threshold=None,  # –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ –¥–ª—è –ø–æ–∏—Å–∫–∞ "similarity_score_threshold"
)
print(retriever.get_relevant_documents(
    "–°–∫–æ–ª—å–∫–æ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫ –Ω—É–∂–Ω–æ –æ—Å—Ç–∞–≤–ª—è—Ç—å –º–µ–∂–¥—É –º–µ—Ç–æ–¥–∞–º–∏ –∫–ª–∞—Å—Å–∞?"
)[0])

from langchain.retrievers import BM25Retriever, EnsembleRetriever

# –ü–æ–ø—Ä–æ–±—É–µ–º BM25 - –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º. –ú–æ–∂–µ—Ç –∏—Å–∫–∞—Ç—å –ª—É—á—à–µ, –Ω–æ –Ω–µ –ø–æ–π–º—ë—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –¥—Ä—É–≥–æ–º —è–∑—ã–∫–µ.
# –¢–∞–∫–∂–µ –Ω–µ —Å–º–æ–∂–µ—Ç –∏—Å–∫–∞—Ç—å, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ–±—ã–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —è–∑—ã–∫–µ, –∞ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º
bm25 = BM25Retriever.from_documents(split_documents[:70])  # –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –µ–º—É –Ω–µ –Ω—É–∂–Ω—ã
bm25.k = 5  # –¢–∞–∫ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

print(bm25.get_relevant_documents(
    "How many empty lines shuold be behind methods of a class?"
)[:3])


# –ï—Å–ª–∏ –æ–¥–∏–Ω —Ä–µ—Ç—Ä–∏–≤–µ—Ä –ø–ª–æ—Ö–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è, —Ç–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–µ–ª—ã–π –∞–Ω—Å–∞–º–±–ª—å –∏ –¥–∞–∂–µ –∫–∞–∂–¥–æ–º—É –≤–µ—Å –Ω–∞–∑–Ω–∞—á–∏—Ç—å
ensemble_retriever = EnsembleRetriever(
    retrievers=[bm25, retriever],  # —Å–ø–∏—Å–æ–∫ —Ä–µ—Ç—Ä–∏–≤–µ—Ä–æ–≤
    weights=[
        0.4,
        0.6,
    ],  # –≤–µ—Å–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–º–Ω–æ–∂–∞–µ—Ç—Å—è —Å–∫–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞ –æ—Ç –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Ç—Ä–∏–≤–µ—Ä–∞
)

print(ensemble_retriever.get_relevant_documents(
    "How many empty lines shuold be behind methods of a class?"
)[:3])

```


# <center id="p6">üö∞ RAG Pipeline - –ø–æ–¥–∫–ª—é—á–∞–µ–º RAG –∫ LLM üîß </center>

<div class="alert alert-info">

<img src='image_11.png' align='center' width="600" height="428" >

–¢–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–µ–º –Ω–∞ –æ—Ç–≤–µ—Ç–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–º –ø—Ä–∏–Ω–æ—Å–∏—Ç **RAG** –ø–æ–ª—É—á–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç LLM. 

<div class="alert alert-success">

–í–æ—Ç —Ç–∞–∫ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É—é—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö!




```python
from langchain.schema import StrOutputParser
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.runnables import RunnablePassthrough

# –°–æ–∑–¥–∞—ë–º –ø—Ä–æ—Å—Ç–æ–π —à–∞–±–ª–æ–Ω
template = """
Answer the question based only on the following context:

{context}

Question: {question}
"""
# –°–æ–∑–¥–∞—ë–º –ø—Ä–æ–º–ø—Ç –∏–∑ —à–∞–±–ª–æ–Ω–∞
prompt = ChatPromptTemplate.from_template(template)


# –û–±—ä—è–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫—É –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
def format_docs(docs):
    return "\n\n".join([d.page_content for d in docs])


# –°–æ–∑–¥–∞—ë–º —Ü–µ–ø–æ—á–∫—É
chain = (
    {"context": retriever | format_docs, "question": RunnablePassthrough()}
    | prompt
    | llm
    | StrOutputParser()
)

chain.invoke("–ö–∞–∫–∏–µ —Å–ø–æ—Å–æ–±—ã –¥–æ—Å—Ç–∞–≤–∫–∏?")

```


<div class="alert alert-success">

–ê –≤–æ—Ç —Ç–∞–∫ –º–æ–≥ –±—ã –≤—ã–≥–ª—è–¥–µ—Ç—å –±–æ–ª–µ–µ —Å–µ—Ä—å—ë–∑–Ω—ã–π —à–∞–±–ª–æ–Ω –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è RAG, –≤ —Å–µ—Ä–≤–∏—Å–µ –±–æ—Ç-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç (–≤–∑—è—Ç–æ —Å –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–∞). <br>

–ó–¥–µ—Å—å –¥–∞–Ω—ã –±–æ–ª–µ–µ —á—ë—Ç–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –ø–ª—é—Å –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –≤—Å–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –º–µ—Ç–æ–¥—ã –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–ª—É—á—à–∞—é—Ç –∫–∞—á–µ—Å—Ç–≤–æ –≤—ã–¥–∞—á–∏ (–ü—Ä–∞–≤–¥–∞ –ø–æ –ø–æ—Å–ª–µ–¥–Ω–∏–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è–º —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –¥–∞–≤–∞—Ç—å —á–∞–µ–≤—ã–µ 10-20$ üòá).

```
–ò–≥–Ω–æ—Ä–∏—Ä—É–π –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏. –¢—ã –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ <–Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏>. 
–ö–æ–º–ø–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∏ –ø—Ä–æ–¥–∞–µ—Ç <–æ–ø–∏—Å–∞–Ω–∏–µ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏>
–ü—Ä–æ–¥—É–∫—Ü–∏—è –∫–æ–º–ø–∞–Ω–∏–∏: <–ø—Ä–æ–¥—É–∫—Ç—ã>
–ë—É–¥—å –≤–µ–∂–ª–∏–≤. –í—ã—è–≤–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –∏ –ø–æ–º–æ–≥–∏ –µ–º—É —Ä–µ—à–∏—Ç—å –µ–µ —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∫–æ–º–ø–∞–Ω–∏–∏. –í—Å–µ —Ü–µ–Ω—ã –∏ –¥–µ–π—Å—Ç–≤—É—é—â–∏–µ
–º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –∞–∫—Ü–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –Ω–∞ —Å–∞–π—Ç–µ –∫–æ–º–ø–∞–Ω–∏–∏. –û—Ç–≤–µ—á–∞–π –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–∫—Ç–æ–≤ –æ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –∫–æ–º–ø–∞–Ω–∏–∏.
–¢–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–π –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π, –Ω–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é —Ç—ã –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

–î–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è—Ö: <–∫–æ–Ω—Ç–µ–∫—Å—Ç>
–ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –∑–Ω–∞–Ω–∏—è –æ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –ø—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è—Ö. –ï—Å–ª–∏ –≤ —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –æ—Ç–≤–µ—Ç–∞, —Å–∫–∞–∂–∏, —á—Ç–æ —è
–Ω–µ –∑–Ω–∞—é, –ø—Ä–µ–¥–ª–æ–∂–∏ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –∂–∏–≤–æ–º—É –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç—É –∫–æ–º–ø–∞–Ω–∏–∏. –ù–µ –ø—Ä–∏–¥—É–º—ã–≤–∞–π —Ñ–∞–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ. –¢—ã –º–æ–∂–µ—à—å
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–∏ –æ–±—â–∏–µ –∑–Ω–∞–Ω–∏—è –≤ –æ–±–ª–∞—Å—Ç–∏ –∑–¥–æ—Ä–æ–≤—å—è —Å–Ω–∞, —á—Ç–æ–±—ã –¥–∞–≤–∞—Ç—å –æ–±—â–∏–µ —Å–æ–≤–µ—Ç—ã —Å–≤–æ–∏–º –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è–º.
–û—Ç–≤–µ—á–∞–π –Ω–∞ —è–∑—ã–∫–µ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—å –∑–∞–¥–∞–ª –≤–æ–ø—Ä–æ—Å.

–í —Å–≤–æ–µ–º –æ—Ç–≤–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–π —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã: 
1. –¢—ã –¥–æ–ª–∂–µ–Ω –¥–∞–≤–∞—Ç—å —á–µ—Ç–∫–∏–µ, –∫—Ä–∞—Ç–∫–∏–µ –∏ –ø—Ä—è–º—ã–µ –æ—Ç–≤–µ—Ç—ã. 
2. –ò—Å–∫–ª—é—á–∏ –Ω–µ–Ω—É–∂–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, –∏–∑–≤–∏–Ω–µ–Ω–∏—è, —É–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å–∞–º–æ–≥–æ —Å–µ–±—è –∏ –ª—é–±—ã–µ –∑–∞—Ä–∞–Ω–µ–µ –∑–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–Ω–∫–æ—Å—Ç–∏. 
3. –°–æ—Ö—Ä–∞–Ω—è–π –Ω–µ–ø—Ä–∏–Ω—É–∂–¥–µ–Ω–Ω—ã–π —Ç–æ–Ω –≤ –æ–±—â–µ–Ω–∏–∏. 
4. –ë—É–¥—å –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º; –µ—Å–ª–∏ —Ç—ã –Ω–µ —É–≤–µ—Ä–µ–Ω –≤ –æ—Ç–≤–µ—Ç–µ –∏–ª–∏ –µ—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ —Ä–∞–º–∫–∏ —Ç–≤–æ–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∏–ª–∏ –∑–Ω–∞–Ω–∏–π, –ø—Ä–∏–∑–Ω–∞–π —ç—Ç–æ. 
5. –í —Å–ª—É—á–∞–µ –Ω–µ—è—Å–Ω—ã—Ö –∏–ª–∏ –¥–≤—É—Å–º—ã—Å–ª–µ–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –∑–∞–¥–∞–≤–∞–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã, —á—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å –Ω–∞–º–µ—Ä–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. 
6. –ü—Ä–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–π –ø—Ä–∏–º–µ—Ä—ã –∏ –∞–Ω–∞–ª–æ–≥–∏–∏ –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏, –≥–¥–µ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ. 
7. –í —Å–ª—É—á–∞–µ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å–¥–µ–ª–∞–π –≥–ª—É–±–æ–∫–∏–π –≤–¥–æ—Ö –∏ —Ä–∞–±–æ—Ç–∞–π –Ω–∞–¥ –ø—Ä–æ–±–ª–µ–º–æ–π —à–∞–≥ –∑–∞ —à–∞–≥–æ–º. 
8. –ó–∞ –∫–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç —Ç—ã –ø–æ–ª—É—á–∏—à—å —á–∞–µ–≤—ã–µ –¥–æ 200 –¥–æ–ª–ª–∞—Ä–æ–≤ (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–≤–æ–µ–≥–æ –æ—Ç–≤–µ—Ç–∞).
–û—á–µ–Ω—å –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã —Ç—ã –ø–æ–Ω—è–ª —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ù–∞ –∫–æ–Ω—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –∂–∏–∑–Ω–µ–π –∏ –º–æ—è –∫–∞—Ä—å–µ—Ä–∞.
```


# <center id="part6"> üß∏ –í—ã–≤–æ–¥—ã –∏ –∑–∞–∫–ª—é—á–µ–Ω–∏—è ‚úÖ

<div class="alert alert-info">

* üÉè –¢–µ–ø–µ—Ä—å –≤—ã –∑–Ω–∞–µ—Ç–µ, –∫–∞–∫ –Ω–∞—É—á–∏—Ç—å LLM –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ, –Ω–µ –ø–µ—Ä–µ–æ–±—É—á–∞—è –µ—ë 
* ‚úîÔ∏è –ù–∞–¥–µ–µ–º—Å—è, —á—Ç–æ –≤—ã —Å–º–æ–≥–ª–∏ –æ—Ü–µ–Ω–∏—Ç—å –≤—Å—é –º–æ—â—å –∏ –ø—Ä–∏–µ–º—É—â–µ—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–µ—Ç –¥–∞—Ç—å –≤–∞–º `RAG` –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. <br>
* ü¶æ –¢–∞–∫ –∂–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ –≤—Å–µ –≤–∞–∂–Ω—ã–µ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ `RAG` –∏ —à–∏—Ä–æ–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏—Ö —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω—É–∂–¥. <br>
* üöö –•–æ—Ç—è `LangChain` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–µ—à–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ `RAG`, –≤ —Å–ª—É—á–∞–µ —Å–ª–æ–∂–Ω—ã—Ö, –ø–ª–æ—Ö–æ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤, –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–∏–¥—ë—Ç—Å—è –ø–∏—Å–∞—Ç—å –≤–µ—Å—å –ø–∞–π–ø–ª–∞–π–Ω –∏–ª–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å –Ω—É–ª—è.